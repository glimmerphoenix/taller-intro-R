<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>8&nbsp; Análisis exploratorio de datos – Taller de Introducción a R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./09-visual.html" rel="next">
<link href="./07-data-in-out.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./08-EDA.html">Ejemplo práctico</a></li><li class="breadcrumb-item"><a href="./08-EDA.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Análisis exploratorio de datos</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Taller de Introducción a R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Instalación y conceptos básicos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Rlang.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">El lenguaje R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-install.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Instalación de R y R Studio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Organización de proyectos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">El lenguaje R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-Rbase.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Programación básica en R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-data-types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tipos de datos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-tidy-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Tidy data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-data-in-out.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Importación y exportación de datos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Ejemplo práctico</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-EDA.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Análisis exploratorio de datos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-visual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Creación de gráficos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Modelos con R</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-add-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Recursos adicionales</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referencias</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Apéndices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A-command-ref.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Comandos de utilidad</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B-IDEs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Entornos de desarrollo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Paquetes R destacados</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-refs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referencias</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#datos-de-ejemplo" id="toc-datos-de-ejemplo" class="nav-link active" data-scroll-target="#datos-de-ejemplo"><span class="header-section-number">8.1</span> Datos de ejemplo</a></li>
  <li><a href="#carga-de-datos-y-esquema-tipos-de-datos" id="toc-carga-de-datos-y-esquema-tipos-de-datos" class="nav-link" data-scroll-target="#carga-de-datos-y-esquema-tipos-de-datos"><span class="header-section-number">8.2</span> Carga de datos y esquema (tipos de datos)</a></li>
  <li><a href="#operaciones-básicas" id="toc-operaciones-básicas" class="nav-link" data-scroll-target="#operaciones-básicas"><span class="header-section-number">8.3</span> Operaciones básicas</a>
  <ul class="collapse">
  <li><a href="#operaciones-de-selección" id="toc-operaciones-de-selección" class="nav-link" data-scroll-target="#operaciones-de-selección"><span class="header-section-number">8.3.1</span> Operaciones de selección</a></li>
  <li><a href="#transformación-de-datos" id="toc-transformación-de-datos" class="nav-link" data-scroll-target="#transformación-de-datos"><span class="header-section-number">8.3.2</span> Transformación de datos</a></li>
  </ul></li>
  <li><a href="#resúmenes-estadísticos" id="toc-resúmenes-estadísticos" class="nav-link" data-scroll-target="#resúmenes-estadísticos"><span class="header-section-number">8.4</span> Resúmenes estadísticos</a>
  <ul class="collapse">
  <li><a href="#el-paquete-hmisc" id="toc-el-paquete-hmisc" class="nav-link" data-scroll-target="#el-paquete-hmisc"><span class="header-section-number">8.4.1</span> El paquete <code>Hmisc</code></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./08-EDA.html">Ejemplo práctico</a></li><li class="breadcrumb-item"><a href="./08-EDA.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Análisis exploratorio de datos</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Análisis exploratorio de datos</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>El Análisis Exploratorio de Datos (<em>Exploratory Data Analysis</em> o EDA) <span class="citation" data-cites="tukey1977">(<a href="references.html#ref-tukey1977" role="doc-biblioref">Tukey, 1977</a>)</span> es un conjunto de técnicas estadísticas y de visualización de datos que permiten identificar las características más relevantes de un conjunto de datos sin intentar aplicar un modelo o algoritmo en particular.</p>
<p>A continuación, veremos varios ejemplos que ilustran cómo realizar operaciones básicas de EDA con R.</p>
<section id="datos-de-ejemplo" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="datos-de-ejemplo"><span class="header-section-number">8.1</span> Datos de ejemplo</h2>
<p>Utilizaremos ejemplos del paquete <code>agriTutorial</code> <span class="citation" data-cites="agriTutorial2020">(<a href="references.html#ref-agriTutorial2020" role="doc-biblioref">Rodney Edmondson et&nbsp;al., 2020</a>)</span>, que incluye conjuntos de datos y ejemplos de modelos sobre exprimentos en agricultura. También usaremos el paquete R <code>agridat</code> <span class="citation" data-cites="agridat2024">(<a href="references.html#ref-agridat2024" role="doc-biblioref">Wright, 2024</a>)</span>, que contiene conjuntos de datos provenientes de publicaciones relacionadas con la agricultura, incluyendo cultivos de campo, cultivos arbóreos o estudios con animales, entre otros.</p>
<p><strong>Paquete <code>agriTutorial</code></strong></p>
<ul>
<li><p><code>greenrice</code>: Datos de un experimento sobre absorción de nitrogeno (N), medido en g/maceta en un experimento de doble factor en invernadero <span class="citation" data-cites="gomez1984">(<a href="references.html#ref-gomez1984" role="doc-biblioref">Gomez &amp; Gomez, 1984</a>)</span>. Se considera la duración del estrés hídrico (W) y el nivel de aplicación de nitrógeno. El experimento se llevó a cabo con cuatro niveles de estrés hídrico (0, 10, 20 y 40 días) como tratamientos de parcela principal (<em>main-plot treatment</em>) y cuatro dosis de nitrógeno (0, 90, 180 y 270 kg/ha) como tratamientos de subparcela (<em>sub-plot treatment</em>). Las parcelas principales se aleatorizaron en cuatro bloques completos (cada bloque incluye todos las posibles combinaciones de tratamientos).</p></li>
<li><p><code>rice</code>: Datos de un experimento con tres prácticas de gestión (<code>minimum</code>, <code>optimum</code>, <code>intensive</code>), cinco cantidades distintas de fertilizante de nitrógeno (N) (0, 50, 80, 110, 140 kg/ha) y tres variedades de planta (<code>V1</code>, <code>V2</code>, <code>V3</code>) <span class="citation" data-cites="gomez1984">(<a href="references.html#ref-gomez1984" role="doc-biblioref">Gomez &amp; Gomez, 1984</a>)</span>. El experimento sigue un diseño de parcelas divididas (<em>split-plot design</em>), donde la variedad de planta y el tipo de gestión son factores de tratamiento cualitativos y la cantidad de fertilizante de nitrógeno es un factor de tratamiento cuantitativo.</p></li>
</ul>
<p><strong>Paquete <code>agridat</code></strong></p>
<ul>
<li><code>nass.barley</code>, <code>nass.corn</code>, <code>nass.rice</code>, <code>nass.soybean</code> y <code>nass.wheat</code>: Cinco conjunto de datos con valores de producción y superficie (en acres) cosechados en cada estado de EE.UU. para los cultivos agrícolas más importantes en este país, entre aproximadamente el año 1900 y el 2011. [<em>Fuente</em>: United States Department of Agriculture, National Agricultural Statistics Service. <a href="https://quickstats.nass.usda.gov/" class="uri">https://quickstats.nass.usda.gov/</a>]</li>
</ul>
</section>
<section id="carga-de-datos-y-esquema-tipos-de-datos" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="carga-de-datos-y-esquema-tipos-de-datos"><span class="header-section-number">8.2</span> Carga de datos y esquema (tipos de datos)</h2>
<p>Los conjuntos de datos de ejemplo ya se encuentran disponibles en cada uno de los paquetes mencionados. Sin embargo, vamos a hacer una prueba para verificar cómo podemos escribir y leer datos en R, por ejemplo utilizando un fichero CSV (muy común para almacenamiento de datos estructurados).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Podemos utilizar la función <code>write.csv()</code> para escribir datos en un fichero en formato CSV que almacenemos en una ubicación de nuestro disco.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agridat)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agriTutorial)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Carga de datos en memoria</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"nass.corn"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"nass.corn"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"greenrice"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"rice"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Escritura de datos a un fichero CSV</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(nass.barley, <span class="st">"data/nass_barley.csv"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(nass.corn, <span class="st">"data/nass_corn.csv"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(greenrice, <span class="st">"data/greenrice.csv"</span>, <span class="at">row.names =</span> F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Podemos utilizar la función <code>read_csv()</code> del paquete <code>readr</code> para leer datos de un fichero en formato CSV almacenado en una ubicación de nuestro disco.</p>
<p>La lectura de datos será más rápida si indicamos explícitamente el tipo de dato que almacena cada columna mediante la función <code>cols()</code> y utilizando las funciones que denotan cada tipo de datos específico: <code>col_integer()</code>, <code>col_character()</code>, <code>col_double()</code>, etc.).</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Leemos los datos de los ficheros CSV creados antes</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>nass_barley <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/nass_barley.csv"</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="fu">col_integer</span>(), <span class="fu">col_character</span>(),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">col_double</span>(), <span class="fu">col_double</span>()))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>nass_corn <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/nass_corn.csv"</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="fu">col_integer</span>(), <span class="fu">col_character</span>(),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">col_double</span>(), <span class="fu">col_double</span>()))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>green_rice <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/greenrice.csv"</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="fu">col_double</span>(), <span class="fu">col_integer</span>(), </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">col_integer</span>(), <span class="fu">col_integer</span>(), <span class="fu">col_integer</span>()))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Una vez que hemos cargado los datos de un paquete R o los hemos leído de un fichero, podemos imprimir en pantalla información acerca de la tabla de datos para comprobar, por ejemplo, que todas las columnas se han identificado correctamente y el tipo de dato de cada columna es correcto.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Los datos en muchos paquetes R están en formato <code>data.frame</code>, menos potente que los objetos <code>tibble</code> creados mediante funciones como <code>read_csv()</code>. Podemos crear automáticamente un objeto <code>tibble</code> a partir de un <code>data.frame</code> con la función <code>tibble()</code>:</p>
<p><code>my_tibble &lt;- tibble(greenrice)</code></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Para comprobar los metadatos de un tabla en formato <code>tibble</code> podemos usar la función <code>str()</code>.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(nass_barley)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [4,839 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ year : int [1:4839] 1866 1866 1866 1866 1866 1866 1866 1866 1866 1866 ...
 $ state: chr [1:4839] "Connecticut" "Illinois" "Indiana" "Iowa" ...
 $ acres: num [1:4839] 1000 96000 11000 66000 2000 10000 34000 7000 21000 20000 ...
 $ yield: num [1:4839] 22.5 23.4 23 22 23 23.5 21.5 25.5 26 26 ...
 - attr(*, "spec")=
  .. cols(
  ..   year = col_integer(),
  ..   state = col_character(),
  ..   acres = col_double(),
  ..   yield = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
</section>
<section id="operaciones-básicas" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="operaciones-básicas"><span class="header-section-number">8.3</span> Operaciones básicas</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># Operaciones de selección y filtrado de datos</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr) <span class="co"># Operaciones de transformación y procesado de datos</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="operaciones-de-selección" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="operaciones-de-selección"><span class="header-section-number">8.3.1</span> Operaciones de selección</h3>
<p><strong>Selección de columnas</strong></p>
<p>Para seleccionar determinadas columnas (y todas sus filas) usamos la función <code>select()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>green_rice_uptake <span class="ot">&lt;-</span> <span class="fu">select</span>(green_rice, Replicate, Main, uptake)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(green_rice_uptake)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [64 × 3] (S3: tbl_df/tbl/data.frame)
 $ Replicate: int [1:64] 1 1 1 1 1 1 1 1 1 1 ...
 $ Main     : int [1:64] 1 1 1 1 2 2 2 2 3 3 ...
 $ uptake   : num [1:64] 1.033 0.506 0.692 0.254 0.154 ...</code></pre>
</div>
</div>
<p><strong>Filtrado de filas</strong></p>
<p>Podemos añadir condiciones adicionales de filtrado (mediante expresiones booleanas) que se utilicen para recuperar sólo las filas de esa columna o columnas que cumplan cierta condición.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>corn_MI <span class="ot">&lt;-</span> <span class="fu">filter</span>(nass_corn, state <span class="sc">==</span> <span class="st">"Michigan"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(corn_MI)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
   year state     acres yield
  &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;
1  1866 Michigan 480000  32  
2  1867 Michigan 500000  36  
3  1868 Michigan 560000  33  
4  1869 Michigan 540000  28  
5  1870 Michigan 570000  39  
6  1871 Michigan 600000  33.5</code></pre>
</div>
</div>
<p>También se pueden imponer simultáneamente varias condiciones de filtrado. En ese caso, es común utilizar el operador <code>%in%</code>, para comprobar valores dentro de un conjunto finito de opciones válidas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>corn_pnw <span class="ot">&lt;-</span> <span class="fu">filter</span>(nass_corn, state <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Idaho"</span>, <span class="st">"Oregon"</span>, <span class="st">"Washington"</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(corn_pnw)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
   year state  acres yield
  &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
1  1869 Oregon  3000  25  
2  1870 Oregon  3000  23  
3  1871 Oregon  4000  25  
4  1872 Oregon  4000  26.5
5  1873 Oregon  4000  26  
6  1874 Oregon  4000  25  </code></pre>
</div>
</div>
<p>Por último, también se pueden usar valores obtenidos como resultado de otras operaciones. Por ejemplo, veamos cómo recuperar sólo las filas que tengan un valor de superficie menor que la mediana de esa variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>corn_low_surf <span class="ot">&lt;-</span> <span class="fu">filter</span>(nass_corn, acres <span class="sc">&lt;</span> <span class="fu">median</span>(nass_corn<span class="sc">$</span>acres))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(corn_low_surf)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
   year state        acres yield
  &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;
1  1866 Arkansas    280000    18
2  1866 California   42000    28
3  1866 Connecticut  57000    34
4  1866 Delaware    200000    23
5  1866 Florida     125000     9
6  1866 Kansas      217000    28</code></pre>
</div>
</div>
<p><strong>Filtrado de columnas</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>green_rice_W <span class="ot">&lt;-</span> <span class="fu">select</span>(green_rice, <span class="sc">-</span>uptake, <span class="sc">-</span>N)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(green_rice_W)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [64 × 3] (S3: tbl_df/tbl/data.frame)
 $ W        : int [1:64] 10 10 10 10 40 40 40 40 0 0 ...
 $ Replicate: int [1:64] 1 1 1 1 1 1 1 1 1 1 ...
 $ Main     : int [1:64] 1 1 1 1 2 2 2 2 3 3 ...</code></pre>
</div>
</div>
<p><strong>Ordenación de datos</strong></p>
<p>Es posible ordenar en función de los valores de una columna o de varias mediante la función <code>arrange()</code>. En el caso de que usemos varias, primero se ordena por los valores de la primera columna y, para cada uno de ellos, por los valores de la siguiente columna especificada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>barley_byState <span class="ot">&lt;-</span> <span class="fu">arrange</span>(nass_barley, state)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(barley_byState)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
   year state   acres yield
  &lt;int&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
1  1943 Alabama  5000  18  
2  1944 Alabama  5000  20.5
3  1945 Alabama  2000  20  
4  1946 Alabama  2000  18  
5  1947 Alabama  1000  18  
6  1948 Alabama  2000  19  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>barley_byYear_yield <span class="ot">&lt;-</span> <span class="fu">arrange</span>(nass_barley, year, yield)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(barley_byYear_yield)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
   year state         acres yield
  &lt;int&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;
1  1866 Texas          3000  16  
2  1866 Pennsylvania  30000  18.5
3  1866 Missouri       9000  21  
4  1866 Maine         34000  21.5
5  1866 Iowa          66000  22  
6  1866 New Hampshire  4000  22  </code></pre>
</div>
</div>
<p>Por defecto, la ordenación se hace en sentido ascendente para valores numéricos (de menor a mayor valor) y en orden alfabético para cadenas de caracteres (datos cualitativos).</p>
<p>Si queremos invertir el orden de la operación de ordenación podemos usar la función <code>desc()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>barley_byYear_desc <span class="ot">&lt;-</span> <span class="fu">arrange</span>(nass_barley, <span class="fu">desc</span>(year),)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(barley_byYear_desc)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
   year state       acres yield
  &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;
1  2011 Alaska       4800  36.5
2  2011 Arizona     64000 125  
3  2011 California  75000  63  
4  2011 Colorado    63000 126  
5  2011 Delaware    32000  88  
6  2011 Idaho      500000  93  </code></pre>
</div>
</div>
<p><strong>Selección de filas</strong></p>
<p>La función <code>slice()</code> nos permite seleccionar un conjunto de filas según su índice, teniendo en cuenta que la primera fila tiene el índice 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recuperamos 90 observaciones, de la fila 11 a la 100</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>barley_10_100 <span class="ot">&lt;-</span> nass_barley <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">slice</span>(<span class="dv">11</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(barley_10_100)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 90</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>La función <code>slice()</code> viene acompañada de otras funciones de ayuda que implementan casos comunes: <code>slice_head()</code>, <code>slice_tail()</code>, <code>slice_sample()</code>, <code>slice_min()</code>, <code>slice_max()</code>. Para conocer más detalles consulta la <a href="https://dplyr.tidyverse.org/reference/slice.html">página de documentación de <code>slice()</code></a>.</p>
</div>
</div>
</section>
<section id="transformación-de-datos" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="transformación-de-datos"><span class="header-section-number">8.3.2</span> Transformación de datos</h3>
<p><strong>Definición de nuevas variables</strong></p>
<p>Se pueden definir nuevas columnas que representen variables adicionales mediante la función <code>mutate()</code>. Para cada nueva variable, especificamos el nombre de la columna y la operación a realizar para obtener cada valor de esa nueva columna. Se pueden utilizar los valores de otras columnas previas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>corn_high_surf <span class="ot">&lt;-</span> <span class="fu">mutate</span>(nass_corn, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">harvest_index =</span> acres<span class="sc">/</span>yield,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">year_factor =</span> <span class="fu">as.factor</span>(year),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">is_high =</span> acres <span class="sc">&gt;</span> <span class="fu">median</span>(acres),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">crop =</span> <span class="st">"corn"</span>, </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">relative_yld =</span> yield<span class="sc">/</span><span class="fu">mean</span>(yield))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(corn_high_surf)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
   year state   acres yield harvest_index year_factor is_high crop  relative_yld
  &lt;int&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt; &lt;fct&gt;       &lt;lgl&gt;   &lt;chr&gt;        &lt;dbl&gt;
1  1866 Alaba… 1.05e6     9       116667. 1866        TRUE    corn         0.172
2  1866 Arkan… 2.8 e5    18        15556. 1866        FALSE   corn         0.343
3  1866 Calif… 4.20e4    28         1500  1866        FALSE   corn         0.534
4  1866 Conne… 5.7 e4    34         1676. 1866        FALSE   corn         0.649
5  1866 Delaw… 2   e5    23         8696. 1866        FALSE   corn         0.439
6  1866 Flori… 1.25e5     9        13889. 1866        FALSE   corn         0.172</code></pre>
</div>
</div>
<p><strong>Renombrado de columnas</strong></p>
<p>Se puede cambiar el nombre de una columna con la función <code>rename(dataframe, newname = "oldname")</code>.</p>
<p><strong>Separación de valores</strong></p>
<p>Puede ocurrir que los datos no cumplan los criterios de <em>tidy data</em>, por ejemplo, porque existan múltiples valores en una misma celda. Para este caso podemos usar varias funciones del paquete <code>tidyr</code> que operan sobre <a href="https://tidyr.tidyverse.org/reference/index.html#character-vectors">vectores de tipo caracter</a>.</p>
<p>Por otro lado, también podemos necesitar unir dos o más columnas, creando un valor único a partir del valor de origen de cada columna. Esto puede ser útil, por ejemplo, para usar esa nueva columna en la búsqueda de valores coincidentes entre dos conjuntos de datos. En ese caso podemos usar la función <code>unite()</code> (<a href="https://tidyr.tidyverse.org/reference/unite.html" class="uri">https://tidyr.tidyverse.org/reference/unite.html</a>).</p>
<!-- ### Combinación de tablas de datos (funciones `join`)

Las operaciones de tipo `join` permiten combinar las filas de dos o más tablas
atendiendo a los valores de una o varias columnas que se toman como referencia
de la comparación. -->
</section>
</section>
<section id="resúmenes-estadísticos" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="resúmenes-estadísticos"><span class="header-section-number">8.4</span> Resúmenes estadísticos</h2>
<ul>
<li><p>La función <code>group_by()</code> permite obtener resúmenes de datos agrupando por una variable categórica (o bien una cuantitativa que tratemos como categórica, por ejemplo año, mes, etc.).</p></li>
<li><p>Por otro lado, la función <code>summarise()</code> suele aparecer detrás de un comando de agrupación como el anterior, para aplicar una función de resumen de datos (media, mediana, etc.) a todo el conjunto de datos o a cada uno de los grupos que hemos generado.</p></li>
</ul>
<p>La utilización del operador integrado <em>pipe</em> (<code>|&gt;</code>) elimina la necesidad de utilizar muchos objetos/variables para guardar los resultados intermedios, quedando un código más limpio y fácil de interpretar.</p>
<p>Por ejemplo, calculamos el promedio de producción anual de cebada en todos los estados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>barley_annual_mean <span class="ot">&lt;-</span> nass_barley <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean_yield =</span> <span class="fu">mean</span>(yield, <span class="at">na.rm =</span> T))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(barley_annual_mean)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
   year mean_yield
  &lt;int&gt;      &lt;dbl&gt;
1  1866       23.3
2  1867       22.9
3  1868       22.2
4  1869       23.9
5  1870       22.4
6  1871       22.2</code></pre>
</div>
</div>
<p>Para el estudio con parcelas divididas del arroz en invernadero, podemos obtener la mediana de producción por cada tipo de estrategia de gestión en todas las combinaciones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>rice_mean_yield <span class="ot">&lt;-</span> rice <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(management) <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">median_yield =</span> <span class="fu">median</span>(yield, <span class="at">na.rm =</span> T))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rice_mean_yield)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  management median_yield
  &lt;fct&gt;             &lt;dbl&gt;
1 Minimum            5.78
2 Optimum            6.36
3 Intensive          7.25</code></pre>
</div>
</div>
<p>Y ahora también tenemos en cuenta la replica experimental para desglosar aún más la mediana de la producción.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>rice_mean_yield_by_rep <span class="ot">&lt;-</span> rice <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(management, Replicate) <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">median_yield =</span> <span class="fu">median</span>(yield, <span class="at">na.rm =</span> T))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'management'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rice_mean_yield_by_rep)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
# Groups:   management [2]
  management Replicate median_yield
  &lt;fct&gt;      &lt;fct&gt;            &lt;dbl&gt;
1 Minimum    R1                5.60
2 Minimum    R2                5.99
3 Minimum    R3                5.39
4 Optimum    R1                6.40
5 Optimum    R2                6.46
6 Optimum    R3                5.90</code></pre>
</div>
</div>
<section id="el-paquete-hmisc" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="el-paquete-hmisc"><span class="header-section-number">8.4.1</span> El paquete <code>Hmisc</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>Hmisc<span class="sc">::</span><span class="fu">html</span>(<span class="fu">describe</span>(green_rice))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<style>
.earrows {color:silver;font-size:11px;}

fcap {
 font-family: Verdana;
 font-size: 12px;
 color: MidnightBlue
 }

smg {
 font-family: Verdana;
 font-size: 10px;
 color: 󅒐
}

hr.thinhr { margin-top: 0.15em; margin-bottom: 0.15em; }

span.xscript {
position: relative;
}
span.xscript sub {
position: absolute;
left: 0.1em;
bottom: -1ex;
}
</style>

<title>green_rice Descriptives</title>
<font color="MidnightBlue"><div align="center"><span style="font-weight:bold">green_rice <br><br> 5  Variables   64  Observations</span></div></font>
<hr class="thinhr">
<span style="font-weight:bold">uptake</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAJcAAAANCAMAAACTvAxuAAAB2lBMVEUAAAABAQECAgIDAwMEBAQGBgYICAgJCQkKCgoLCwsNDQ0PDw8QEBARERESEhIUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxsdHR0gICAiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKysuLi4vLy8wMDAxMTEzMzM0NDQ1NTU3Nzc4ODg5OTk8PDw9PT1BQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlLS0tMTExOTk5QUFBSUlJTU1NWVlZXV1daWlpbW1tdXV1hYWFlZWVpaWltbW1wcHBycnJzc3N0dHR1dXV2dnZ6enp8fHx+fn5/f3+AgICFhYWHh4eIiIiJiYmKioqLi4uNjY2QkJCRkZGSkpKTk5OVlZWZmZmcnJydnZ2enp6fn5+hoaGioqKmpqapqamqqqqtra2vr6+ysrK0tLS1tbW3t7e6urq8vLy9vb2/v7/Dw8PExMTFxcXHx8fIyMjJycnKysrMzMzOzs7Pz8/Q0NDU1NTV1dXW1tbY2NjZ2dna2trb29vc3Nze3t7f39/g4ODh4eHi4uLk5OTl5eXm5ubo6Ojr6+vt7e3u7u7v7+/w8PDy8vL09PT19fX29vb5+fn6+vr7+/v8/Pz9/f3+/v7///+Peqk2AAAB0ElEQVQ4je2V11NTURCHfymQAKEjvYMi2EECIQEEpMYSlGYDsVCkQ0Clu0AEAwcuYERx/1fvMckMmUkenMEZHvI97J3fnbN7vzn3YSH8LOG5CMXlu2dTY0rIg+cG2M82XnMorlrOpvupIQ+eG2Gvf+Mie21M9DmF8hadm/63q4fDB2vq033w9TMr3zx5ZnYd8+9VPp1RPIsNSYMKu+e//GQ+/uA6+bjgkT1uhU6Odtiztev0TTmc+xH4MbHHvLvPm8t/0/qv4Erft6QXERkAfYUZ0CWTl1GUogzTRIU2E4bqc9qRRqYWeofxfljsujgNblIutL1EVsR0abQdsinfqnvSlEptUQVY8I6p0zgogPJrRMU1dMkog1PzjILSGq0WeV96VclcBWgTfcazKFHNVpjz66Mw1Zj5GOlsfMBj+DSEGgdigRucDfQz22B4BThkU64NL5qT+JE+DzveMffQE3gTldeZi2ycHCmDC2+C39fDCN9/DHuFvf6bl7qLVC/t7TtqifctpzEU4wpmhcixGjFSl96BNGFoEe8xOYBKO0xAmcgA+oSohqEbsMumLAueNiWINn02lr1jauEIXHq3SoUosIjESBkW8TL4amyNUMsfKE2QmoPRqXgAAAAASUVORK5CYII=" alt="image"></div>
<pre style="font-size:85%;">        n  missing distinct     Info     Mean      Gmd      .05      .10      .25 
       64        0       61        1   0.4582   0.3277  0.09815  0.10540  0.21400 
      .50      .75      .90      .95 
  0.45500  0.61450  0.83450  1.02910  </pre>

<span style="font-size: 85%;"><font color="MidnightBlue">lowest</font>&nbsp;: 0.084 0.089 0.093 0.098 0.099 ,  <font color="MidnightBlue">highest</font>: 1.007 1.033 1.034 1.089 1.297</span>
<hr class="thinhr">
<span style="font-weight:bold">W</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAMAAABFNRROAAAAMFBMVEUAAACQkJCcnJyjo6OpqamwsLC2tra/v7/ExMTKysrV1dXZ2dna2trr6+vs7Oz////AoE3/AAAAM0lEQVQIma3OORIAIAjAwHjgBcj/f2trr2WanYBmhiDursCurE6PiP1QM9EKxczmN/P+PLQ+BNgnVP4YAAAAAElFTkSuQmCC" alt="image"></div>
<style>
 .hmisctable659242 {
 border: none;
 font-size: 85%;
 }
 .hmisctable659242 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable659242 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table data-quarto-disable-processing="true" class="hmisctable659242">
 <tbody><tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>64</td><td>0</td><td>4</td><td>0.938</td><td>17.5</td><td>16.51</td></tr>
 </tbody></table>

<pre style="font-size:85%;"> Value         0   10   20   40
 Frequency    16   16   16   16
 Proportion 0.25 0.25 0.25 0.25 </pre>


For the frequency table, variable is rounded to the nearest 0
<hr class="thinhr">
<span style="font-weight:bold">N</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAMAAABFNRROAAAAJFBMVEUAAACWlpaioqKwsLC+vr7KysrOzs7Z2dna2trr6+vs7Oz///9owtBAAAAAMklEQVQIma3OuREAIAzEQOEDP7j/fknJIVSyI4gyZk2sAtgtvB31fqiVA6UYub6Z9+cBMcMDW4Oz1acAAAAASUVORK5CYII=" alt="image"></div>
<style>
 .hmisctable646602 {
 border: none;
 font-size: 85%;
 }
 .hmisctable646602 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable646602 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table data-quarto-disable-processing="true" class="hmisctable646602">
 <tbody><tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>64</td><td>0</td><td>4</td><td>0.938</td><td>135</td><td>114.3</td></tr>
 </tbody></table>

<pre style="font-size:85%;"> Value         0   90  180  270
 Frequency    16   16   16   16
 Proportion 0.25 0.25 0.25 0.25 </pre>


For the frequency table, variable is rounded to the nearest 0
<hr class="thinhr">
<span style="font-weight:bold">Replicate</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAMAAABFNRROAAAAJFBMVEUAAACWlpaioqKwsLC+vr7KysrOzs7Z2dna2trr6+vs7Oz///9owtBAAAAAMklEQVQIma3OuREAIAzEQOEDP7j/fknJIVSyI4gyZk2sAtgtvB31fqiVA6UYub6Z9+cBMcMDW4Oz1acAAAAASUVORK5CYII=" alt="image"></div>
<style>
 .hmisctable164099 {
 border: none;
 font-size: 85%;
 }
 .hmisctable164099 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable164099 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table data-quarto-disable-processing="true" class="hmisctable164099">
 <tbody><tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>64</td><td>0</td><td>4</td><td>0.938</td><td>2.5</td><td>1.27</td></tr>
 </tbody></table>

<pre style="font-size:85%;"> Value         1    2    3    4
 Frequency    16   16   16   16
 Proportion 0.25 0.25 0.25 0.25 </pre>


For the frequency table, variable is rounded to the nearest 0
<hr class="thinhr">
<span style="font-weight:bold">Main</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAMAAABFNRROAAAAJFBMVEUAAACWlpaioqKwsLC+vr7KysrOzs7Z2dna2trr6+vs7Oz///9owtBAAAAAMklEQVQIma3OuREAIAzEQOEDP7j/fknJIVSyI4gyZk2sAtgtvB31fqiVA6UYub6Z9+cBMcMDW4Oz1acAAAAASUVORK5CYII=" alt="image"></div>
<style>
 .hmisctable338846 {
 border: none;
 font-size: 85%;
 }
 .hmisctable338846 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable338846 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table data-quarto-disable-processing="true" class="hmisctable338846">
 <tbody><tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>64</td><td>0</td><td>4</td><td>0.938</td><td>2.5</td><td>1.27</td></tr>
 </tbody></table>

<pre style="font-size:85%;"> Value         1    2    3    4
 Frequency    16   16   16   16
 Proportion 0.25 0.25 0.25 0.25 </pre>


For the frequency table, variable is rounded to the nearest 0
<hr class="thinhr">
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-gomez1984" class="csl-entry" role="listitem">
Gomez, K. A., &amp; Gomez, A. A. (1984). <em><span>Statistical Procedures for Agricultural Research</span></em>. John Wiley &amp; Sons.
</div>
<div id="ref-agriTutorial2020" class="csl-entry" role="listitem">
Rodney Edmondson, Hans-Peter Piepho, &amp; Muhammad Yaseen. (2020). <em><span>agriTutorial: Tutorial Analysis of Some Agricultural Experiments </span></em>.
</div>
<div id="ref-tukey1977" class="csl-entry" role="listitem">
Tukey, J. W. (1977). <em>Exploratory Data Analysis</em> (1.ª ed.). Addison-Wesley Pub.
</div>
<div id="ref-agridat2024" class="csl-entry" role="listitem">
Wright, K. (2024). <em><span>agridat: Agricultural Datasets</span></em>. <a href="https://CRAN.R-project.org/package=agridat">https://CRAN.R-project.org/package=agridat</a>
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./07-data-in-out.html" class="pagination-link" aria-label="Importación y exportación de datos">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Importación y exportación de datos</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./09-visual.html" class="pagination-link" aria-label="Creación de gráficos">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Creación de gráficos</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>